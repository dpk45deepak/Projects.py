<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To-Do App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Enable dark mode toggle
      if (
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.classList.add("dark");
      } else {
        document.documentElement.classList.remove("dark");
      }
    </script>
  </head>

  <body
    class="bg-gray-50 text-gray-800 dark:bg-gray-950 dark:text-gray-200 transition-colors duration-500"
  >
    <!-- Header -->
    <header
      class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-6 shadow-md"
    >
      <div
        class="max-w-5xl mx-auto flex flex-col md:flex-row items-center justify-between px-6"
      >
        <h1 class="text-3xl font-bold tracking-wide">üìù My To-Do App</h1>
        <nav class="mt-4 md:mt-0 flex items-center gap-4">
          <a
            href="#todo"
            class="hover:text-yellow-300 transition font-medium"
            >Tasks</a
          >
          <a
            href="#about"
            class="hover:text-yellow-300 transition font-medium"
            >About</a
          >
          <a
            href="#contact"
            class="hover:text-yellow-300 transition font-medium"
            >Contact</a
          >

          <!-- Dark Mode Toggle -->
          <button
            id="themeToggle"
            class="ml-4 px-3 py-1 bg-black/30 dark:bg-white/20 rounded-full text-sm hover:scale-105 transition"
          >
            üåô
          </button>
        </nav>
      </div>
    </header>

    <!-- Hero Section -->
    <section
      class="bg-indigo-50 dark:bg-gray-900 py-20 text-center transition-colors"
    >
      <h2
        class="text-4xl md:text-5xl font-extrabold text-indigo-700 dark:text-indigo-400 mb-6"
      >
        Stay Organized and Productive
      </h2>
      <p
        class="text-lg max-w-2xl mx-auto text-gray-700 dark:text-gray-300 leading-relaxed"
      >
        Add, track, and complete your daily tasks easily with our simple and
        intuitive to-do app.
      </p>
      <div class="mt-8">
        <a
          href="#todo"
          class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full shadow-lg transition duration-300"
        >
          Start Managing Tasks
        </a>
      </div>
    </section>

    <!-- To-Do Section -->
    <section id="todo" class="py-20 max-w-2xl mx-auto px-6">
      <h2
        class="text-3xl font-bold text-center text-indigo-700 dark:text-indigo-400 mb-12"
      >
        Your Tasks
      </h2>

      <div
        class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700"
      >
        <!-- Add Task Form -->
        <form id="taskForm" class="flex gap-4 mb-6">
          <input
            type="text"
            id="taskInput"
            placeholder="Add a new task..."
            class="flex-1 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-400 dark:bg-gray-900 dark:text-gray-200"
          />
          <button
            type="submit"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition"
          >
            Add
          </button>
        </form>

        <!-- Task List -->
        <ul id="taskList" class="space-y-3"></ul>
      </div>
    </section>

    <!-- About Section -->
    <section
      id="about"
      class="bg-gray-100 dark:bg-gray-900 py-20 text-center px-6 transition-colors"
    >
      <h2
        class="text-3xl font-bold text-indigo-700 dark:text-indigo-400 mb-6"
      >
        About This App
      </h2>
      <p
        class="max-w-3xl mx-auto text-gray-700 dark:text-gray-300 leading-relaxed"
      >
        This simple To-Do app helps you manage your daily tasks efficiently.
        Mark tasks as completed, add new tasks, and stay productive throughout
        the day.
      </p>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 max-w-3xl mx-auto px-6 text-center">
      <h2
        class="text-3xl font-bold text-indigo-700 dark:text-indigo-400 mb-6"
      >
        Contact Us
      </h2>
      <p class="text-gray-700 dark:text-gray-300 mb-6">
        Have questions? Reach out to us anytime.
      </p>
      <a
        href="mailto:info@todoapp.com"
        class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full shadow-md transition duration-300"
      >
        Send Email
      </a>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 py-6 text-center">
      <p>¬© 2025 My To-Do App | Organize Your Life</p>
    </footer>

    <!-- JavaScript -->
    <script>
      const taskForm = document.getElementById("taskForm");
      const taskInput = document.getElementById("taskInput");
      const taskList = document.getElementById("taskList");
      const themeToggle = document.getElementById("themeToggle");

      // Function to render tasks
      function renderTasks(tasks) {
        taskList.innerHTML = "";
        tasks.forEach(task => {
          const li = document.createElement("li");
          li.className = "flex items-center justify-between bg-gray-100 dark:bg-gray-700 p-3 rounded-lg shadow-sm hover:bg-gray-200 dark:hover:bg-gray-600 transition";
          li.innerHTML = `
            <span>${task.name}</span>
            <button data-id="${task.id}" class="text-red-500 hover:text-red-700 font-bold">‚úï</button>
          `;
          taskList.appendChild(li);
        });
      }

      // Fetch tasks on page load
      async function fetchTasks() {
        try {
          const response = await fetch("/task");
          const tasks = await response.json();
          renderTasks(tasks);
        } catch (error) {
          console.error("Error fetching tasks:", error);
        }
      }

      // Add task
      taskForm.addEventListener("submit", async function (e) {
        e.preventDefault();
        const taskText = taskInput.value.trim();
        if (!taskText) return;

        try {
          const response = await fetch("/task", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name: taskText, description: "" }),
          });
          const newTask = await response.json();
          fetchTasks(); // Re-fetch to update list
          taskInput.value = "";
        } catch (error) {
          console.error("Error adding task:", error);
        }
      });
      
      // Delete task
      taskList.addEventListener("click", async function(e) {
        if (e.target.tagName === "BUTTON") {
          const taskId = e.target.dataset.id;
          try {
            await fetch(`/task/${taskId}`, { method: "DELETE" });
            fetchTasks(); // Re-fetch to update list
          } catch (error) {
            console.error("Error deleting task:", error);
          }
        }
      });

      // Dark mode toggle
      themeToggle.addEventListener("click", () => {
        document.documentElement.classList.toggle("dark");
        if (document.documentElement.classList.contains("dark")) {
          localStorage.theme = "dark";
          themeToggle.textContent = "‚òÄÔ∏è";
        } else {
          localStorage.theme = "light";
          themeToggle.textContent = "üåô";
        }
      });

      // Set correct toggle icon on load
      if (document.documentElement.classList.contains("dark")) {
        themeToggle.textContent = "‚òÄÔ∏è";
      } else {
        themeToggle.textContent = "üåô";
      }
      
      // Initial fetch
      fetchTasks();
    </script>
  </body>
</html>
